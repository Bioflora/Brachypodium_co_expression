---
title: "Mean Connectivity for D data set"
author: "Ruben Sancho, Bruno Contreras Moreira"
output:
  html_document: default
  pdf_document: default
---

```{r knitr setup, include=FALSE,  eval=TRUE, echo=FALSE, warning=FALSE}
library(knitr)
knitr::opts_chunk$set(eval=TRUE, cache=FALSE, message=FALSE, warning=FALSE,
                      comment = "")
```


```{r connectivity}

# Display the current working directory
getwd();
workingDir = ".";
setwd(workingDir);


# Load the WGCNA package
workingDir = ".";
setwd(workingDir);
library(WGCNA);
options(stringsAsFactors = FALSE);
allowWGCNAThreads();

# Load data and networks
load(file = "net_D_unsigned.RData")
load(file = "adj_D.RData")


#Modules D:


#    0     1     2     3     4     5     6     7     8     9 
#11366  2477   979   750   318   214   111    68    65    38 


#    black      blue     brown     green      grey   magenta      pink       red 
#       68       979       750       214     11366        38        65       111 
#turquoise    yellow 
#     2477       318 




# INTRAMODULAR CONNECTIVITY:

kIM_D = intramodularConnectivity(adj_D, moduleColors_D, scaleByMax = F)


# 1 (turquoise)
which.color = "turquoise";
restrictGenes=moduleColors_D==which.color
kdiff_turquoise = kIM_D$kDiff[ restrictGenes]
mean_kdiff_turquoise = mean(kdiff_turquoise)
paste("mean kdiff 1 (turquoise)=", mean_kdiff_turquoise)

# 2 (blue)
which.color="blue";
restrictGenes=moduleColors_D==which.color
kdiff_blue = kIM_D$kDiff[ restrictGenes]
mean_kdiff_blue = mean(kdiff_blue)
paste("mean kdiff 2 (blue)=", mean_kdiff_blue)


# 3 (brown)
which.color="brown";
restrictGenes=moduleColors_D==which.color
kdiff_brown = kIM_D$kDiff[ restrictGenes]
mean_kdiff_brown = mean(kdiff_brown)
paste("mean kdiff 3 (brown)=", mean_kdiff_brown)

# 4 (yellow)
which.color="yellow";
restrictGenes=moduleColors_D==which.color
kdiff_yellow = kIM_D$kDiff[ restrictGenes]
mean_kdiff_yellow = mean(kdiff_yellow)
paste("mean kdiff 4 (yellow)=", mean_kdiff_yellow)

# 5 (green)

which.color="green";
restrictGenes=moduleColors_D==which.color
kdiff_green = kIM_D$kDiff[ restrictGenes]
mean_kdiff_green = mean(kdiff_green)
paste("mean kdiff 5 (green)=", mean_kdiff_green)

# 6 (red)

which.color="red";
restrictGenes=moduleColors_D==which.color
kdiff_red = kIM_D$kDiff[ restrictGenes]
mean_kdiff_red = mean(kdiff_red)
paste("mean kdiff 6 (red)=", mean_kdiff_red)

# 7 (black)

which.color="black";
restrictGenes=moduleColors_D==which.color
kdiff_black = kIM_D$kDiff[ restrictGenes]
mean_kdiff_black = mean(kdiff_black)
paste("mean kdiff 7 (black)=", mean_kdiff_black)

# 8 (pink)
which.color="pink";
restrictGenes=moduleColors_D==which.color
kdiff_pink = kIM_D$kDiff[ restrictGenes]
mean_kdiff_pink = mean(kdiff_pink)
paste("mean kdiff 8 (pink)=", mean_kdiff_pink)

# 9 (magenta)
which.color="magenta";
restrictGenes=moduleColors_D==which.color
kdiff_magenta = kIM_D$kDiff[ restrictGenes]
mean_kdiff_magenta = mean(kdiff_magenta)
paste("mean kdiff 9 (magenta)=", mean_kdiff_magenta)

```
